<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Color Utils Visual Test</title>
  <style>
    body { font-family: sans-serif; }
    .color-block { display: inline-block; width: 100px; height: 100px; margin: 10px; border: 1px solid #ccc; vertical-align: middle; }
    .label { text-align: center; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h2>Color Utils Visual Test</h2>
  <div>
    <label>Base Color: <input type="color" id="baseColor" value="#ff0000"></label>
    <label style="margin-left:20px;">Rotation Angle: <input type="range" id="angleSlider" min="0" max="360" value="45" step="1"> <span id="angleValue">45</span>°</label>
    <button onclick="updateBlocks()">Update</button>
  </div>
  <div id="blocks"></div>
  <h3>Pure Color Rotations Table</h3>
  <div id="pureColorTable"></div>
  <script>
    function rotateColor(color, degree) {
      let r = 0, g = 0, b = 0;
      if (color.startsWith('#')) {
        const hex = color.replace('#', '');
        r = parseInt(hex.substring(0, 2), 16);
        g = parseInt(hex.substring(2, 4), 16);
        b = parseInt(hex.substring(4, 6), 16);
      }
      r /= 255; g /= 255; b /= 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b);
      let h = 0, s = 0, l = (max + min) / 2;
      if (max !== min) {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
      h = (h + degree / 360) % 1;
      if (h < 0) h += 1;
      let r1, g1, b1;
      if (s === 0) {
        r1 = g1 = b1 = l;
      } else {
        const hue2rgb = (p, q, t) => {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        };
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r1 = hue2rgb(p, q, h + 1/3);
        g1 = hue2rgb(p, q, h);
        b1 = hue2rgb(p, q, h - 1/3);
      }
      const toHex = x => Math.round(x * 255).toString(16).padStart(2, '0');
      return `#${toHex(r1)}${toHex(g1)}${toHex(b1)}`;
    }
    function maxRGBColor(colorA, colorB) {
      const parse = color => {
        if (color.startsWith('#')) {
          const hex = color.replace('#', '');
          return [
            parseInt(hex.substring(0, 2), 16),
            parseInt(hex.substring(2, 4), 16),
            parseInt(hex.substring(4, 6), 16)
          ];
        }
        return [0, 0, 0];
      };
      const [r1, g1, b1] = parse(colorA);
      const [r2, g2, b2] = parse(colorB);
      const r = Math.max(r1, r2);
      const g = Math.max(g1, g2);
      const b = Math.max(b1, b2);
      const toHex = x => x.toString(16).padStart(2, '0');
      return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
    }
    function updateBlocks() {
      const base = document.getElementById('baseColor').value;
      const angle = parseInt(document.getElementById('angleSlider').value);
      document.getElementById('angleValue').textContent = angle;
      const customRot = rotateColor(base, angle);
      const inv = rotateColor(base, 180);
      const mir = rotateColor(base, 90);
      const rot270 = rotateColor(base, 270);
      const maxInv = maxRGBColor(base, inv);
      const maxMir = maxRGBColor(base, mir);
      const max270 = maxRGBColor(base, rot270);
      const maxCustom = maxRGBColor(base, customRot);
      const blocks = [
        { label: 'Base', color: base },
        { label: `Rotate (${angle}°)`, color: customRot },
        { label: 'Invert (180°)', color: inv },
        { label: 'Mirror (90°)', color: mir },
        { label: 'Rotate (270°)', color: rot270 },
        { label: 'MaxRGB(Base, Invert)', color: maxInv },
        { label: 'MaxRGB(Base, Mirror)', color: maxMir },
        { label: 'MaxRGB(Base, Rotate 270°)', color: max270 },
        { label: `MaxRGB(Base, Rotate ${angle}°)`, color: maxCustom }
      ];
      const container = document.getElementById('blocks');
      container.innerHTML = blocks.map(b => `
        <div class="label">${b.label}</div>
        <div class="color-block" style="background:${b.color}"></div>
      `).join('');
    }

    // Pure colors: R, G, B, C, M, Y, W, K
    // ROYGBIV order: Red, Orange, Yellow, Green, Blue, Indigo, Violet
    // We'll use Magenta for Violet, and add Orange/Indigo as best approximations
    const pureColors = [
      { name: 'Red', hex: '#ff0000' },
      { name: 'Yellow', hex: '#ffff00' },
      { name: 'Green', hex: '#00ff00' },
      { name: 'Cyan', hex: '#00ffff' },
      { name: 'Blue', hex: '#0000ff' },
      { name: 'Magenta', hex: '#ff00ff' },
      { name: 'White', hex: '#ffffff' },
      { name: 'Black', hex: '#000000' }
    ];
    const rotationAngles = [0, 90, 180, 270];

    function renderPureColorTable() {
      let html = '<table border="1" cellpadding="4" style="border-collapse:collapse;text-align:center;"><tr><th>Angle</th>';
      pureColors.forEach(c => {
        html += `<th>${c.name}<br><span style="background:${c.hex};display:inline-block;width:20px;height:20px;"></span></th>`;
      });
      html += '</tr>';
      rotationAngles.forEach(angle => {
        html += `<tr><td>${angle}°</td>`;
        pureColors.forEach(c => {
          const rot = rotateColor(c.hex, angle);
          html += `<td><span style="background:${rot};display:inline-block;width:40px;height:20px;border:1px solid #ccc;"></span><br>${rot}</td>`;
        });
        html += '</tr>';
      });
      html += '</table>';
      document.getElementById('pureColorTable').innerHTML = html;
    }

    renderPureColorTable();
    updateBlocks();
    document.getElementById('baseColor').addEventListener('input', updateBlocks);
    document.getElementById('angleSlider').addEventListener('input', updateBlocks);
  </script>
</body>
</html>
